(window.webpackJsonpf91c48b4_3ffd_4446_8577_375b07a62c9f_3_0_0=window.webpackJsonpf91c48b4_3ffd_4446_8577_375b07a62c9f_3_0_0||[]).push([[2],{xNkf:function(e,t,n){"use strict";n.r(t),n.d(t,"PropertyFieldPeoplePicker",function(){return Y}),n.d(t,"PrincipalType",function(){return a});var a,i=n("cDcd"),r=n("faye"),o=n("26ea");!function(e){e[e.Users=1]="Users",e[e.Security=4]="Security",e[e.SharePoint=8]="SharePoint"}(a||(a={}));var s=n("CwRq"),c=n("7nsc"),d=n("FbcY"),l=n("WOvX"),u=n("QoT3"),f=n("iBHr"),p=n("9h5o"),m=n("mWkG"),_=n("glAF"),h=n("vTSs"),b=n("2WvF"),g=n("tqYG"),v=n("QmzK"),y={root:"ms-PickerPersona-container",itemContent:"ms-PickerItem-content",removeButton:"ms-PickerItem-removeButton",isSelected:"is-selected",isInvalid:"is-invalid"},S=Object(p.a)(),D=Object(l.a)(function(e){var t=e.item,n=e.onRemoveItem,a=e.index,r=e.selected,o=e.removeButtonAriaLabel,c=e.styles,d=e.theme,l=e.className,u=e.disabled,p=Object(m.a)(),g=S(c,{theme:d,className:l,selected:r,disabled:u,invalid:t.ValidationState===f.a.warning}),v=g.subComponentStyles?g.subComponentStyles.persona:void 0,y=g.subComponentStyles?g.subComponentStyles.personaCoin:void 0;return i.createElement("div",{className:g.root,"data-is-focusable":!u,"data-is-sub-focuszone":!0,"data-selection-index":a,role:"listitem","aria-labelledby":"selectedItemPersona-"+p},i.createElement("div",{className:g.itemContent,id:"selectedItemPersona-"+p},i.createElement(_.a,Object(s.a)({size:h.c.size24,styles:v,coinProps:{styles:y}},t))),i.createElement(b.a,{onClick:n,disabled:u,iconProps:{iconName:"Cancel",styles:{root:{fontSize:"12px"}}},className:g.removeButton,ariaLabel:o}))},function(e){var t,n,a,i,r,o,c,d,l=e.className,u=e.theme,f=e.selected,p=e.invalid,m=e.disabled,_=u.palette,h=u.semanticColors,b=u.fonts,S=Object(g.s)(y,u),D=[f&&!p&&!m&&{color:_.white,selectors:(t={":hover":{color:_.white}},t[g.e]={color:"HighlightText"},t)},(p&&!f||p&&f&&m)&&{color:_.redDark,borderBottom:"2px dotted "+_.redDark,selectors:(n={},n["."+S.root+":hover &"]={color:_.redDark},n)},p&&f&&!m&&{color:_.white,borderBottom:"2px dotted "+_.white},m&&{selectors:(a={},a[g.e]={color:"GrayText"},a)}],I=[f&&!p&&!m&&{color:_.white,selectors:(i={":hover":{color:_.white}},i[g.e]={color:"HighlightText"},i)}],x=[p&&{fontSize:b.xLarge.fontSize}];return{root:[S.root,Object(g.r)(u,{inset:-2}),{borderRadius:15,display:"inline-flex",alignItems:"center",background:_.neutralLighter,margin:"1px 2px",cursor:"default",userSelect:"none",maxWidth:300,verticalAlign:"middle",minWidth:0,selectors:(r={":hover":{background:f||m?"":_.neutralLight}},r[g.e]=[{border:"1px solid WindowText"},m&&{borderColor:"GrayText"}],r)},f&&!m&&[S.isSelected,{background:_.themePrimary,selectors:(o={},o[g.e]=Object(s.a)({borderColor:"HighLight",background:"Highlight"},Object(g.t)()),o)}],p&&[S.isInvalid],p&&f&&!m&&{background:_.redDark},l],itemContent:[S.itemContent,{flex:"0 1 auto",minWidth:0,maxWidth:"100%",overflow:"hidden"}],removeButton:[S.removeButton,{borderRadius:15,color:_.neutralPrimary,flex:"0 0 auto",width:24,height:24,selectors:{":hover":{background:_.neutralTertiaryAlt,color:_.neutralDark}}},f&&[{color:_.white,selectors:(c={":hover":{color:_.white,background:_.themeDark},":active":{color:_.white,background:_.themeDarker}},c[g.e]={color:"HighlightText"},c)},p&&{selectors:{":hover":{background:_.red},":active":{background:_.redDark}}}],m&&{selectors:(d={},d["."+v.a.msButtonIcon]={color:h.buttonText},d)}],subComponentStyles:{persona:{primaryText:D,secondaryText:I},personaCoin:{initials:x}}}},void 0,{scope:"PeoplePickerItem"}),I=n("VvEo"),x={root:"ms-PeoplePicker-personaContent",personaWrapper:"ms-PeoplePicker-Persona"},C=Object(p.a)(),O=Object(l.a)(function(e){var t=e.personaProps,n=e.suggestionsProps,a=e.compact,r=e.styles,o=e.theme,c=e.className,d=C(r,{theme:o,className:n&&n.suggestionsItemClassName||c}),l=d.subComponentStyles&&d.subComponentStyles.persona?d.subComponentStyles.persona:void 0;return i.createElement("div",{className:d.root},i.createElement(_.a,Object(s.a)({size:h.c.size24,styles:l,className:d.personaWrapper,showSecondaryText:!a,showOverflowTooltip:!1},t)))},function(e){var t,n,a,i=e.className,r=e.theme,o=Object(g.s)(x,r),s={selectors:(t={},t["."+I.a.isSuggested+" &"]={selectors:(n={},n[g.e]={color:"HighlightText"},n)},t["."+o.root+":hover &"]={selectors:(a={},a[g.e]={color:"HighlightText"},a)},t)};return{root:[o.root,{width:"100%",padding:"4px 12px"},i],personaWrapper:[o.personaWrapper,{width:180}],subComponentStyles:{persona:{primaryText:s,secondaryText:s}}}},void 0,{scope:"PeoplePickerItemSuggestion"}),w={root:"ms-BasePicker",text:"ms-BasePicker-text",itemsWrapper:"ms-BasePicker-itemsWrapper",input:"ms-BasePicker-input"};function E(e){var t,n,a,i=e.className,r=e.theme,o=e.isFocused,s=e.inputClassName,c=e.disabled;if(!r)throw new Error("theme is undefined or null in base BasePicker getStyles function.");var d=r.semanticColors,l=r.effects,u=r.fonts,f=d.inputBorder,p=d.inputBorderHovered,m=d.inputFocusBorderAlt,_=Object(g.s)(w,r),h=[u.medium,{color:d.inputPlaceholderText,opacity:1,selectors:(t={},t[g.e]={color:"GrayText"},t)}],b={color:d.disabledText,selectors:(n={},n[g.e]={color:"GrayText"},n)},v="rgba(218, 218, 218, 0.29)";return{root:[_.root,i],text:[_.text,{display:"flex",position:"relative",flexWrap:"wrap",alignItems:"center",boxSizing:"border-box",minWidth:180,minHeight:30,border:"1px solid "+f,borderRadius:l.roundedCorner2},!o&&!c&&{selectors:{":hover":{borderColor:p}}},o&&!c&&Object(g.v)(m,l.roundedCorner2),c&&{borderColor:v,selectors:(a={":after":{content:'""',position:"absolute",top:0,right:0,bottom:0,left:0,background:v}},a[g.e]={borderColor:"GrayText",selectors:{":after":{background:"none"}}},a)}],itemsWrapper:[_.itemsWrapper,{display:"flex",flexWrap:"wrap",maxWidth:"100%"}],input:[_.input,u.medium,{height:30,border:"none",flexGrow:1,outline:"none",padding:"0 6px 0",alignSelf:"flex-end",borderRadius:l.roundedCorner2,backgroundColor:"transparent",color:d.inputText,selectors:{"::-ms-clear":{display:"none"}}},Object(g.w)(h),c&&Object(g.w)(b),s],screenReaderText:g.z}}var A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.c)(t,e),t}(u.a),L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.c)(t,e),t}(u.b),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.c)(t,e),t.defaultProps={onRenderItem:function(e){return i.createElement(D,Object(s.a)({},e))},onRenderSuggestionsItem:function(e,t){return i.createElement(O,{personaProps:e,suggestionsProps:t})},createGenericItem:T},t}(A),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.c)(t,e),t.defaultProps={onRenderItem:function(e){return i.createElement(D,Object(s.a)({},e))},onRenderSuggestionsItem:function(e,t){return i.createElement(O,{personaProps:e,suggestionsProps:t,compact:!0})},createGenericItem:T},t}(A),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.c)(t,e),t.defaultProps={onRenderItem:function(e){return i.createElement(D,Object(s.a)({},e))},onRenderSuggestionsItem:function(e,t){return i.createElement(O,{personaProps:e,suggestionsProps:t})},createGenericItem:T},t}(L);function T(e,t){var n={key:e,primaryText:e,imageInitials:"!",ValidationState:t};return t!==f.a.warning&&(n.imageInitials=Object(c.a)(e,Object(d.a)())),n}var U,F=Object(l.a)(k,E,void 0,{scope:"NormalPeoplePicker"}),H=(Object(l.a)(M,E,void 0,{scope:"CompactPeoplePicker"}),Object(l.a)(P,E,void 0,{scope:"ListPeoplePickerBase"}),n("iMux")),R=n("elao"),N=n("zwa+"),B=n("vlQI"),j=function(){function e(){}return e.prototype.searchPeople=function(e,t,n,a){var i=this;void 0===a&&(a=null);var r="".concat(a||e.pageContext.web.absoluteUrl,"/_api/SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.clientPeoplePickerSearchUser"),o={queryParams:{AllowEmailAddresses:!0,AllowMultipleEntities:!1,AllUrlZones:!1,MaximumEntitySuggestions:20,PrincipalSource:15,PrincipalType:n&&n.length>0?n.reduce(function(e,t){return e+t},0):1,QueryString:t}},s={headers:{accept:"application/json","content-type":"application/json"},body:JSON.stringify(o)};return e.spHttpClient.post(r,B.SPHttpClient.configurations.v1,s).then(function(t){return t.json().then(function(t){var n=JSON.parse(t.value);return(n=(n=n.filter(function(e){return!(e.EntityData&&e.EntityData.PrincipalType&&"UNVALIDATED_EMAIL_ADDRESS"===e.EntityData.PrincipalType)})).filter(function(e){return null!==e.Key})).map(function(t){var n,r;switch(t.EntityType){case"User":return n=null!==t.EntityData.Email?t.EntityData.Email:t.Description,(r={fullName:t.DisplayText,login:t.Description}).id=t.Key,r.email=n,r.jobTitle=t.EntityData.Title,r.initials=i.getFullNameInitials(r.fullName),r.imageUrl=i.getUserPhotoUrl(r.email,a||e.pageContext.web.absoluteUrl),r;case"SecGroup":case"FormsRole":return{fullName:t.DisplayText,login:t.ProviderName,id:t.Key,description:t.Description};default:return{fullName:t.DisplayText,login:t.EntityData.AccountName,id:t.EntityData.SPGroupID,description:t.Description}}})})})},e.prototype.getFullNameInitials=function(e){if(null===e)return e;var t=e.split(" ");return 0===t.length?"":1===t.length?t[0].charAt(0):t[0].charAt(0)+t[1].charAt(0)},e.prototype.getUserPhotoUrl=function(e,t){return e?"".concat(t,"/_layouts/15/userphoto.aspx?size=S&accountname=").concat(encodeURIComponent(e)):null},e}(),V=n("N3ZD"),z=n("TVYz"),G=n("yVpZ"),K=(U=function(e,t){return U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},U(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}U(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),W=function(e){function t(t){var n=e.call(this,t)||this;return n.intialPersonas=new Array,n.resultsPeople=new Array,n.resultsPersonas=new Array,n.selectedPeople=new Array,n.selectedPersonas=new Array,z.a("PropertyFieldPeoplePicker",{allowDuplicate:t.allowDuplicate,principalType:t.principalType?t.principalType.toString():"",disabled:t.disabled}),n.searchService=new j,n.onSearchFieldChanged=n.onSearchFieldChanged.bind(n),n.onItemChanged=n.onItemChanged.bind(n),n.createInitialPersonas(),n.state={resultsPeople:n.resultsPeople,resultsPersonas:n.resultsPersonas,errorMessage:""},n.async=new R.a(n),n.validate=n.validate.bind(n),n.notifyAfterValidate=n.notifyAfterValidate.bind(n),n.delayedValidate=n.async.debounce(n.validate,n.props.deferredValidationTime),n}return K(t,e),t.prototype.onSearchFieldChanged=function(e,t){var n=this;return e.length>2?(this.setState({resultsPeople:this.resultsPeople,resultsPersonas:this.resultsPersonas}),this.searchService.searchPeople(this.props.context,e,this.props.principalType,this.props.targetSiteUrl).then(function(e){return n.resultsPeople=[],n.resultsPersonas=[],!1===n.props.allowDuplicate&&(e=n.removeDuplicates(e)),e.forEach(function(e,t){n.resultsPeople.push(e),n.resultsPersonas.push(n.getPersonaFromPeople(e,t))}),n.setState({resultsPeople:n.resultsPeople,resultsPersonas:n.resultsPersonas}),n.resultsPersonas})):[]},t.prototype.removeDuplicates=function(e){if(null===this.selectedPeople||0===this.selectedPeople.length)return e;for(var t=[],n=0,a=e;n<a.length;n++){for(var i=a[n],r=!1,o=0;o<this.selectedPeople.length;o++){var s=this.selectedPeople[o];if(s.login===i.login&&s.id===i.id){r=!0;break}}!1===r&&t.push(i)}return t},t.prototype.createInitialPersonas=function(){var e=this;null!==this.props.initialData&&typeof this.props.initialData==typeof Array()&&this.props.initialData.forEach(function(t,n){var a=e.getPersonaFromPeople(t,n);e.intialPersonas.push(a),e.selectedPersonas.push(a),e.selectedPeople.push(t)})},t.prototype.getPersonaFromPeople=function(e,t){return{primaryText:e.fullName,secondaryText:e.jobTitle,imageUrl:e.imageUrl,imageInitials:e.initials,presence:h.b.none,initialsColor:this.getRandomInitialsColor(t)}},t.prototype.refreshWebPartProperties=function(){this.delayedValidate(this.selectedPeople)},t.prototype.validate=function(e){var t=this;if(null!==this.props.onGetErrorMessage&&void 0!==this.props.onGetErrorMessage){var n=this.props.onGetErrorMessage(e||[]);n?"string"==typeof n?(""===n&&this.notifyAfterValidate(this.props.initialData,e),this.setState({errorMessage:n})):n.then(function(n){n||t.notifyAfterValidate(t.props.initialData,e),t.setState({errorMessage:n})}).catch(function(){}):(this.notifyAfterValidate(this.props.initialData,e),this.setState({errorMessage:null}))}else this.notifyAfterValidate(this.props.initialData,e)},t.prototype.notifyAfterValidate=function(e,t){this.props.onPropertyChange&&t&&(Object(G.a)(this.props.properties,this.props.targetProperty,t),this.props.onPropertyChange(this.props.targetProperty,e,t),void 0!==this.props.onChange&&null!==this.props.onChange&&this.props.onChange(this.props.targetProperty,t))},t.prototype.componentWillUnmount=function(){this.async.dispose()},t.prototype._findIndex=function(e){for(var t=0;t<this.resultsPersonas.length;t++){var n=this.resultsPersonas[t];if(n.imageUrl===e.imageUrl&&n.primaryText===e.primaryText&&n.secondaryText===e.secondaryText)return t}return-1},t.prototype.onItemChanged=function(e){var t=this;if(e.length>0)if(e.length>this.selectedPersonas.length){var n=this._findIndex(e[e.length-1]);if(n>-1){var a=this.resultsPeople[n];this.selectedPeople.push(a),this.selectedPersonas.push(this.resultsPersonas[n])}}else this.selectedPersonas.forEach(function(n,a){-1===e.indexOf(n)&&(t.selectedPersonas.splice(a,1),t.selectedPeople.splice(a,1))});else this.selectedPersonas.splice(0,this.selectedPersonas.length),this.selectedPeople.splice(0,this.selectedPeople.length);this.refreshWebPartProperties()},t.prototype.getRandomInitialsColor=function(e){switch(e%13){default:return h.a.blue;case 1:return h.a.darkBlue;case 2:return h.a.teal;case 3:return h.a.lightGreen;case 4:return h.a.green;case 5:return h.a.darkGreen;case 6:return h.a.lightPink;case 7:return h.a.pink;case 8:return h.a.magenta;case 9:return h.a.purple;case 10:return h.a.black;case 11:return h.a.orange;case 12:return h.a.red;case 13:return h.a.darkRed}},t.prototype.render=function(){var e={suggestionsHeaderText:N.PeoplePickerSuggestedContacts,noResultsFoundText:N.PeoplePickerNoResults,loadingText:N.PeoplePickerLoading};if(this.props.principalType&&this.props.principalType.length>0){var t=-1!==this.props.principalType.indexOf(a.Users),n=-1!==this.props.principalType.indexOf(a.SharePoint)||-1!==this.props.principalType.indexOf(a.Security);t&&n&&(e.suggestionsHeaderText=N.PeoplePickerSuggestedCombined),!t&&n&&(e.suggestionsHeaderText=N.PeoplePickerSuggestedGroups)}return i.createElement("div",null,this.props.label&&i.createElement(H.a,null,this.props.label),i.createElement(F,{disabled:this.props.disabled,pickerSuggestionsProps:e,onResolveSuggestions:this.onSearchFieldChanged,onChange:this.onItemChanged,defaultSelectedItems:this.intialPersonas,itemLimit:this.props.multiSelect?void 0:1}),i.createElement(V.a,{errorMessage:this.state.errorMessage}))},t}(i.Component),q=function(){return q=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},q.apply(this,arguments)},Q=function(){function e(e,t){this.type=o.PropertyPaneFieldType.Custom,this.disabled=!1,this.allowDuplicate=!0,this.multiSelect=!0,this.principalType=[],this.deferredValidationTime=200,this.render=this.render.bind(this),this.label=t.label,this.targetProperty=t.targetProperty,this.properties=t,this.properties.onDispose=this.dispose,this.properties.onRender=this.render,this.onPropertyChange=t.onPropertyChange,this.context=t.context,this.initialData=t.initialData,this.allowDuplicate=t.allowDuplicate,this.principalType=t.principalType,this.targetSiteUrl=t.targetSiteUrl,this.customProperties=t.properties,this.key=t.key,this.onGetErrorMessage=t.onGetErrorMessage,void 0!==t.disabled&&(this.disabled=t.disabled),t.deferredValidationTime&&(this.deferredValidationTime=t.deferredValidationTime),void 0!==t.multiSelect&&(this.multiSelect=t.multiSelect)}return e.prototype.render=function(e,t,n){var a=i.createElement(W,{label:this.label,disabled:this.disabled,targetProperty:this.targetProperty,initialData:this.initialData,allowDuplicate:this.allowDuplicate,multiSelect:this.multiSelect,principalType:this.principalType,onDispose:this.dispose,onRender:this.render,onChange:n,onPropertyChange:this.onPropertyChange,context:this.context,properties:this.customProperties,targetSiteUrl:this.targetSiteUrl,key:this.key,onGetErrorMessage:this.onGetErrorMessage,deferredValidationTime:this.deferredValidationTime});r.render(a,e)},e.prototype.dispose=function(e){},e}();function Y(e,t){return new Q(e,q(q({},t),{targetProperty:e,onDispose:null,onRender:null}))}}}]);